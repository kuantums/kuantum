import { createServerComponentClient } from "@supabase/auth-helpers-nextjs"
import { Database } from "@/types/database.types"
import { cookies } from 'next/headers'
import HumanResource from "./human_resource/menu";
import Ceo from "./ceo/menu";

export const dynamic = 'force-dynamic'

export default async function Dashboard() {
  const cookieStore = cookies();
  const supabase = createServerComponentClient<Database>({ cookies: () => cookieStore });

const { data: user} = await supabase
.from('user_details')
.select('roles, status')


  if (user && user[0].roles === "ceo" && (user[0].status === "active" || user[0].status === "training")) {
    // Render CEO specific dashboard
   return <Ceo />
    
  } else if (user && user[0].roles === "humanres" && (user[0].status === "active" || user[0].status === "training")) {
   return <HumanResource />
   
  }

}

